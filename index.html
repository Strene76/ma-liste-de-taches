<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Covoiturage U15</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        :root {
            --primary-color: #00a8ff;
            --secondary-color: #26de81;
            --background-color: #1e272e;
            --surface-color: #2d3436;
            --hover-color: #0097e6;
            --text-color: #dfe6e9;
            --text-muted: #b2bec3;
            --border-radius: 8px;
            --danger-color: #ff4757;
            --danger-hover: #ee3545;
        }
        
        /* Styles existants */
        /* ... [Tous les styles CSS précédents restent identiques] ... */

        /* Nouveaux styles pour la liste complète des joueurs */
        .liste-complete {
            font-size: 0.85em;
            background: rgba(255, 255, 255, 0.03);
            padding: 10px;
            border-radius: var(--border-radius);
        }

        .liste-complete h3 {
            font-size: 1em;
            margin: 0 0 10px 0;
            color: var(--text-muted);
        }

        .joueur-complet {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 5px;
            font-size: 0.9em;
        }

        .statut-covoiturage {
            font-size: 0.8em;
            padding: 2px 6px;
            border-radius: 4px;
            background-color: var(--secondary-color);
        }

        .sans-covoiturage {
            background-color: var(--text-muted);
        }

        /* ... [Le reste des styles CSS existants] ... */
    </style>
</head>
<body>
    <div class="container">
        <h1>Covoiturage U15</h1>

        <div class="section">
            <h2>Informations du match</h2>
            <div class="match-info">
                <div class="info-grid">
                    <div class="input-group">
                        <label for="dateCovoiturage">Date du match</label>
                        <input type="date" id="dateCovoiturage">
                    </div>
                    <div class="input-group">
                        <label for="heureEntrainement">Heure de l'entraînement</label>
                        <input type="time" id="heureEntrainement">
                    </div>
                    <div class="input-group">
                        <label for="heureMatch">Heure du match</label>
                        <input type="time" id="heureMatch">
                    </div>
                    <div class="input-group full-width">
                        <label for="lieuMatch">Lieu du match</label>
                        <input type="text" id="lieuMatch" placeholder="Adresse du match">
                    </div>
                    <div class="input-group">
                        <label for="heureRdv">Heure du rendez-vous</label>
                        <input type="time" id="heureRdv">
                    </div>
                    <div class="input-group full-width">
                        <label for="lieuRdv">Lieu du rendez-vous</label>
                        <input type="text" id="lieuRdv" placeholder="Point de rendez-vous">
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>Joueurs participant au match</h2>
            <input type="text" id="nouveauJoueurMatch" placeholder="Nom du joueur">
            <button onclick="ajouterJoueurMatch()">Ajouter à la liste</button>
            <div class="liste-complete">
                <h3>Liste complète des joueurs</h3>
                <div id="listeJoueursMatch"></div>
            </div>
        </div>

        <!-- Le reste des sections existantes -->
        <!-- ... [Le reste du HTML existant] ... -->

    </div>
<div class="section">
            <h2>Ajouter un joueur au covoiturage</h2>
            <input type="text" id="nomJoueur" placeholder="Nom du joueur">
            <button onclick="ajouterJoueur()">Ajouter</button>
            <ul id="listeJoueurs"></ul>
        </div>

        <div class="section">
            <h2>Ajouter un conducteur</h2>
            <input type="text" id="nomConducteur" placeholder="Nom du conducteur">
            <select id="trajet">
                <option value="aller">Aller</option>
                <option value="retour">Retour</option>
                <option value="allerRetour">Aller-Retour</option>
            </select>
            <div class="places-container">
                <input type="number" id="nombrePlaces" class="nombre-places" min="1" max="8" value="4">
                <label for="nombrePlaces">nombre de places disponible dans le véhicule</label>
            </div>
            <button onclick="ajouterConducteur()">Ajouter</button>
            <ul id="listeConducteurs"></ul>
        </div>

        <div class="section">
            <h2>Assigner les joueurs aux voitures</h2>
            <select id="selectConducteur"></select>
            <select id="selectJoueur"></select>
            <button onclick="assignerJoueur()">Assigner</button>
        </div>

        <div class="section">
            <h2>Assignations actuelles</h2>
            <div id="assignations"></div>
        </div>
    </div>

    <script>
        // Configuration Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyBapVUX-eTBclzbmhy4lR88aQmoBrSEZ2U",
  authDomain: "ma-liste-de-taches.firebaseapp.com",
  databaseURL: "https://ma-liste-de-taches-default-rtdb.firebaseio.com",
  projectId: "ma-liste-de-taches",
  storageBucket: "ma-liste-de-taches.appspot.com",
  messagingSenderId: "614607808736",
  appId: "1:614607808736:web:d4490906c783cb14040885"
        };

        // Initialiser Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const covoiturageRef = database.ref('covoiturage');

        // Fonction pour ajouter un joueur à la liste complète du match
        function ajouterJoueurMatch() {
            const nom = document.getElementById('nouveauJoueurMatch').value;
            if (nom) {
                covoiturageRef.child('joueursMatch').push({
                    nom: nom,
                    utiliseCovoiturage: false
                });
                document.getElementById('nouveauJoueurMatch').value = '';
            }
        }

        // Gestion des informations du match
        ['dateCovoiturage', 'heureMatch', 'heureEntrainement', 'lieuMatch', 'heureRdv', 'lieuRdv'].forEach(id => {
            document.getElementById(id).addEventListener('change', (e) => {
                covoiturageRef.child('matchInfo').child(id).set(e.target.value);
            });
        });

        // Charger les informations du match
        covoiturageRef.child('matchInfo').on('value', (snapshot) => {
            const matchInfo = snapshot.val() || {};
            ['dateCovoiturage', 'heureMatch', 'heureEntrainement', 'lieuMatch', 'heureRdv', 'lieuRdv'].forEach(id => {
                document.getElementById(id).value = matchInfo[id] || '';
            });
        });

        // [Le reste des fonctions existantes reste identique]

        // Fonction pour mettre à jour la liste complète des joueurs
        function mettreAJourListeJoueursMatch(joueursMatch, joueursCovoiturage) {
            const container = document.getElementById('listeJoueursMatch');
            container.innerHTML = '';

            Object.entries(joueursMatch || {}).forEach(([key, joueur]) => {
                const utiliseCovoiturage = joueursCovoiturage.some(j => j.nom.toLowerCase() === joueur.nom.toLowerCase());
                
                const div = document.createElement('div');
                div.className = 'joueur-complet';

                const nom = document.createElement('span');
                nom.textContent = joueur.nom;
                div.appendChild(nom);

                const statut = document.createElement('span');
                statut.className = `statut-covoiturage ${utiliseCovoiturage ? '' : 'sans-covoiturage'}`;
                statut.textContent = utiliseCovoiturage ? 'Covoiturage' : 'Sans covoiturage';
                div.appendChild(statut);

                const btnSupprimer = document.createElement('button');
                btnSupprimer.textContent = 'x';
                btnSupprimer.className = 'btn-supprimer';
                btnSupprimer.onclick = () => {
                    if(confirm("Supprimer ce joueur de la liste ?")) {
                        covoiturageRef.child('joueursMatch').child(key).remove();
                    }
                };
                div.appendChild(btnSupprimer);

                container.appendChild(div);
            });
        }

        // Mettre à jour l'écouteur principal pour inclure la gestion de la liste complète
        covoiturageRef.on('value', (snapshot) => {
            const data = snapshot.val() || {};
            
            // Créer un tableau des joueurs utilisant le covoiturage
            const joueursCovoiturage = Object.values(data.joueurs || {});

            // Mettre à jour la liste complète des joueurs
            mettreAJourListeJoueursMatch(data.joueursMatch, joueursCovoiturage);

            // [Le reste du code de l'écouteur reste identique]
            // ...

        });

        // [Le reste du code JavaScript reste identique]
        
    </script>
</body>
</html>
